---
title: Lecture 02a -- Sampling designs I
author: Januar Harianto
# format: soles-revealjs
format: revealjs
fontsize: 15pt
# embed-resources: true
# execute:
#   cache: true
---

```{r setup}
#| include: false
if (!require(pacman)) install.packages("pacman")
pacman::p_load(tidyverse, ggthemes)
```


# Today: Observational studies

## Common study types
::: fragment
### Research surveys

- Estimate a statistic (e.g. mean, variance), but
- **no temporal change** during estimate
- *E.g. measuring species richness in a forest*
:::

::: fragment
### Monitoring studies

- Estimate a ***change*** in statistic (same as above), and
- **temporal change** across observations, i.e. before and after
- *E.g. measuring species richness in a forest **before and after a fire***
:::

## Sampling designs

::: fragment
### Simple random sampling

- Each unit has an equal chance of being selected
- **Randomly sample units from the entire population**

![](images/simple_random.png){fig-align="center" height=140}
:::

::: fragment
### Stratified random sampling

- The population is first divided into *strata* (more on this later)
- **Randomly sample units within each strata by simple random sampling, *standardised* by the inclusion probability (or weight) of each strata**

![](images/stratified.png){fig-align="center" height=140}
:::

## Inclusion probability

The mathematical foundation of random sampling rests on the concept of inclusion probability.

::: fragment
### Definition
The probability that a unit from the population will be included in the sample, denoted as $\pi_i$.

$$\pi_i = P(\text{unit }i\text{ is selected})$$
:::

::: fragment
### Properties in simple random sampling
For a sample size $n$ from a population of size $N$:

$$\pi_i = \frac{n}{N} \quad \text{for all units }i$$

This means:

- Every unit has the same probability of being selected
- $0 < \pi_i \leq 1$ for all units
- In simple random sampling, $\pi_i$ is equal for all units
:::

::: fragment
### Implementation
In practice, we achieve random sampling through:

- **Computational methods**: Using R's `sample()` function
  ```r
  # Sample 5 units from a population of 100
  sample(1:100, size = 5, replace = FALSE)
  ```
- **Traditional methods**: Random number tables
:::

::: fragment
### Biological application
In ecological surveys:

- Each quadrat in a field has equal probability of selection
- Each individual in a population has equal chance of being measured
- Each time point has equal likelihood of being sampled
:::

# Interpreting sampled data

## Review of key concepts
### From the previous lecture
::: incremental

- **Sample mean** is a good measure of central tendency
- **Sample variance** is a good measure of dispersion
- **Sample size** affects the precision of the sample mean
:::

::: fragment
### Core question

Can we combine all of the above in a single statistic?
:::

# Confidence intervals
![](images/ci-garfield.png)

## Understanding confidence intervals

::: fragment
### Basic definition
A range of values that likely contains the true population parameter, based on sample data.
:::

::: fragment
### Mathematical form
$$\text{estimate} \pm \text{margin of error}$$

More specifically:
$$\text{estimate} \pm (\text{critical value} \times \text{standard error})$$
:::

::: fragment
### Applications in ecology

- Helps assess precision of ecological measurements
- Guides sample size decisions in field studies
- Enables comparison between different populations
:::

## Interpreting intervals

- Confidence intervals depend on a specified **confidence level** (e.g. 95%, 99%)
- Higher confidence levels produce wider intervals (more conservative)
- Represents our uncertainty about the true population value

::: fragment
### Field example
When measuring tree heights in a forest:

- 95% CI of 20 ± 2 metres means:
- If we repeated this sampling many times
- 95% of intervals would contain the true mean height
- Wider intervals suggest more variable populations
:::

# Soil carbon in forest ecosystems

## Understanding soil carbon

### Ecological importance
::: fragment

- Critical for climate change mitigation
- Indicator of soil health and fertility
- Key factor in forest ecosystem function
:::

::: fragment
### Research challenges

- High spatial variability
- Labour-intensive measurements
- Seasonal fluctuations
:::

## Sample data analysis

```{r, fig.height=4}
# Create data frame for soil samples
soil_data <- tibble(
  location = 1:7,
  carbon = c(48, 56, 90, 78, 86, 71, 42)
)

# Calculate mean and confidence interval
soil_summary <- tibble(
  mean = mean(soil_data$carbon),
  se = sd(soil_data$carbon)/sqrt(length(soil_data$carbon)),
  ci_lower = mean - qt(0.975, df=length(soil_data$carbon)-1) * se,
  ci_upper = mean + qt(0.975, df=length(soil_data$carbon)-1) * se
)

# Plot with ggplot2
ggplot(soil_data, aes(x = "", y = carbon)) +
  geom_jitter(width = 0.1, alpha = 0.6, colour = "forestgreen") +
  geom_crossbar(data = soil_summary, 
                aes(y = mean, ymin = ci_lower, ymax = ci_upper),
                width = 0.3, alpha = 0.2) +
  theme_minimal() +
  labs(x = "", y = "Soil carbon (t/ha)",
       title = "Forest soil carbon content",
       subtitle = "Points show samples, bar shows 95% CI") +
  theme(plot.title = element_text(face = "bold"))
```

## Data processing

::: fragment
### Raw measurements
```{r}
soil <- soil_data$carbon
soil
```
:::

::: fragment
### Statistical components

1. Sample mean calculation
```{r}
mean_soil <- mean(soil)
mean_soil
```

2. Critical value (95% confidence)
```{r}
t_critical <- qt(0.975, df = length(soil) - 1)
t_critical
```

3. Standard error
```{r}
se_mean <- sd(soil) / sqrt(length(soil))
se_mean
```
:::

## Results interpretation

::: fragment
### Confidence interval calculation
```{r}
margin_error <- t_critical * se_mean
ci95 <- c(mean = mean_soil, 
  L95 = mean_soil - margin_error, 
  U95 = mean_soil + margin_error)

ci95
```
:::

::: fragment
### Ecological implications

- Mean soil carbon: 67.3 t/ha
- 95% CI: [52.3, 82.3] t/ha
- Interpretation:
  - Moderate to high carbon content
  - Relatively wide interval suggests high variability
  - More samples needed for higher precision
:::

## Research considerations

::: incremental

- How precise is our estimate of soil carbon?
- What sample size would improve precision?
- **Can we sample more efficiently?**
:::

# Looking ahead: Beyond observational studies

## Understanding different approaches
Our focus today has been on observational studies. However, environmental science uses different approaches depending on the research question.

| Aspect | Observational study | Controlled experiment |
|--------|---------------------|-----------------------|
| **Control** | No control over the variables of interest - **Mensurative** and **Absolute** | Control over the variables of interest - **Comparative** and **Manipulative** |
| **Causation** | Cannot establish causation, but perhaps **association** | Can establish **causation** |
| **Feasibility** | Can be done in many cases | May be destructive and cannot always be done |

::: fragment
This comparison will be important as we move into experimental design in our next lectures.
:::

# Next: Stratified random sampling

## Thanks!

### Questions?

This presentation is based on the [SOLES Quarto reveal.js template][soles-revealjs] and is licensed under a [Creative Commons Attribution 4.0 International License][cc-by] 

<!-- Links -->
[soles-revealjs]: https://github.com/usyd-soles-edu/soles-revealjs
[cc-by]: http://creativecommons.org/licenses/by/4.0/

### [⇣PDF](Lecture-02a.pdf)
